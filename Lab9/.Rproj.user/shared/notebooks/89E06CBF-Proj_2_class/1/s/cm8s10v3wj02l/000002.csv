"0","thresh <- seq(0.1,1.0, length = 10)"
"0","#cost vector"
"0","cost_tr = rep(0,length(thresh))"
"0","#for training set, let's see what threshold is the best to use to minimize costs"
"0","#for training set"
"0","for (i in 1:length(thresh)){"
"0","  "
"0","  glm = rep(""0"", length(glm_mod$fitted.values))"
"0","  glm[glm_mod$fitted.values > thresh[i]] = ""1"""
"0","  glm <- as.factor(glm)"
"0","  x <- confusionMatrix(glm, train.y, positive = ""1"")"
"0","  TN <- x$table[1]"
"0","  FP <- x$table[2]"
"0","  FN <- x$table[3]"
"0","  TP <- x$table[4]"
"0","  cost_tr[i] = 25*FN + TP * (-40) + 10 * FP + TN *(-40)"
"0","}"
"2","Warning in confusionMatrix.default(glm, train.y, positive = ""1"") :"
"2","
 "
"2"," Levels are not in the same order for reference and data. Refactoring data to match.
"
"0","x <- confusionMatrix(glm, train.y, positive = ""1"")"
"2","Warning in confusionMatrix.default(glm, train.y, positive = ""1"") :"
"2","
 "
"2"," Levels are not in the same order for reference and data. Refactoring data to match.
"
"0","TN <- x$table[1]"
"0","FP <- x$table[2]"
"0","FN <- x$table[3]"
"0","TP <- x$table[4]"
"0","cost_simple_tr = 25*FN + TP * (-40) + 10 * FP + TN *(-40)"
"0",""
"0",""
"0",""
"0","# putting results in a dataframe for plotting"
"0","dat <- data.frame("
"0","  model = c(rep(""optimized"",10),""simple""),"
"0","  cost_per_customer = c(cost_tr,cost_simple_tr),"
"0","  threshold = c(thresh,0.5)"
"0",")"
"0",""
"0","# plotting"
"0","plot <- ggplot(dat, aes(x = threshold, y = cost_per_customer, group = model, colour = model)) +"
"0","  geom_line() +"
"0","  geom_point()"
"0",""
"0","plot"
