"0","#This is where the magic starts: special categorization (>=6 is good)"
"0","new_df = df %>% "
"0","  mutate(good = ifelse(quality >= 6, ""1"", ""0"") %>% as.factor()) %>%"
"0","  select(-quality); dim(df)"
"1","[1]"
"1"," 4015"
"1","   12"
"1","
"
"0","table(new_df$good)"
"1","
"
"1","   0 "
"1","   1 "
"1","
"
"1","1203 "
"1","2812 "
"1","
"
"0","#split into test/train"
"0","p=ncol(new_df)"
"0","idx0 <- createDataPartition(new_df$good, p = .9, "
"0","                                   list = FALSE, "
"0","                                   times = 1)"
"0",""
"0",""
"0","off_train.x = new_df[idx0, -p] %>% as.matrix()"
"0","dim(off_train.x)"
"1","[1]"
"1"," 3614"
"1","   11"
"1","
"
"0","off_train.x = off_train.x %>% scale(center=TRUE)"
"0","off_train.y = new_df[idx0, p]"
"0","official_train = data.frame(off_train.x, good=off_train.y)"
"0","dim(official_train)"
"1","[1]"
"1"," 3614"
"1","   12"
"1","
"
"0","off_test.x = new_df[-idx0, -p] %>% as.matrix()"
"0","off_test.x = off_test.x %>% scale(., center=attr(off_train.x, ""scaled:center""),"
"0","                                  scale=attr(off_train.x, ""scaled:scale""))"
"0","off_test.y = new_df[-idx0, p]"
"0","official_test = data.frame(off_test.x, good=off_test.y)"
"0",""
"0",""
"0","#split train into train/validation"
"0","idx = createDataPartition(official_train$good, p = 0.9, list=F)"
"0",""
"0","train.x = official_train[idx, -p] %>% as.matrix(); dim(train.x)"
"1","[1]"
"1"," 3253"
"1","   11"
"1","
"
"0","train.y = official_train[idx, p]; table(train.y)"
"1","train.y
"
"1","   0 "
"1","   1 "
"1","
"
"1"," 975 "
"1","2278 "
"1","
"
"0","train = data.frame(train.x, good=train.y)"
"0",""
"0","test.x = official_train[-idx, -p] %>% as.matrix(); dim(test.x)"
"1","[1]"
"1"," 361"
"1","  11"
"1","
"
"0","test.y = official_train[-idx, p]; table(test.y)"
"1","test.y
"
"1","  0 "
"1","  1 "
"1","
"
"1","108 "
"1","253 "
"1","
"
"0","test = data.frame(test.x, good=test.y)"
