"0","#Let's start with training set, no predictions needed"
"0","#we'll fix a more accurate treshold later: for now let's just stick to basics"
"0","tresh <- 0.5"
"0","# We must transform the estimated probabilities in labels"
"0","stepAicPreds <- ifelse(myfit2.AIC$fitted.values>tresh, ""yes"", ""no"") %>% "
"0","  as.factor()"
"0","stepBicPreds <- ifelse(myfit3.BIC$fitted.values>tresh, ""yes"", ""no"") %>% "
"0","  as.factor()"
"0",""
"0",""
"0","# creating a confusion matrix"
"0","confusionMatrix(stepAicPreds, train$Closed_Account, positive = ""yes"")"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   no"
"1","  yes"
"1","
       no "
"1"," 4942"
"1","  414"
"1","
       yes"
"1","  162"
"1","  560"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.9052          "
"1","
"
"1","                 95% CI :"
"1"," (0.8976, 0.9125)"
"1","
"
"1","    No Information Rate :"
"1"," 0.8397          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," < 2.2e-16       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.6067          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," < 2.2e-16       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.57495         "
"1","
"
"1","            Specificity :"
"1"," 0.96826         "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.77562         "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.92270         "
"1","
"
"1","             Prevalence :"
"1"," 0.16025         "
"1","
"
"1","         Detection Rate :"
"1"," 0.09214         "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.11879         "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.77160         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," yes             "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","confusionMatrix(stepBicPreds, train$Closed_Account, positive = ""yes"")"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   no"
"1","  yes"
"1","
       no "
"1"," 4942"
"1","  419"
"1","
       yes"
"1","  162"
"1","  555"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.9044          "
"1","
"
"1","                 95% CI :"
"1"," (0.8967, 0.9117)"
"1","
"
"1","    No Information Rate :"
"1"," 0.8397          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," < 2.2e-16       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.6024          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," < 2.2e-16       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.56982         "
"1","
"
"1","            Specificity :"
"1"," 0.96826         "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.77406         "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.92184         "
"1","
"
"1","             Prevalence :"
"1"," 0.16025         "
"1","
"
"1","         Detection Rate :"
"1"," 0.09131         "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.11797         "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.76904         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," yes             "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","#Let's now see what we get for validation set"
"0","stepAicPredsOut <- ifelse(predict(myfit2.AIC, newdata=validation, "
"0","                                  type = ""response"")>0.5, ""yes"", ""no"") %>% "
"0","  as.factor()"
"0","stepBicPredsOut <- ifelse(predict(myfit3.BIC, newdata=validation, "
"0","                                  type = ""response"")>0.5, ""yes"", ""no"") %>% "
"0","  as.factor()"
"0",""
"0","confusionMatrix(stepAicPredsOut, validation$Closed_Account, positive = ""yes"")"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   no"
"1","  yes"
"1","
       no "
"1"," 1218"
"1","  109"
"1","
       yes"
"1","   58"
"1","  134"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.8901          "
"1","
"
"1","                 95% CI :"
"1"," (0.8732, 0.9054)"
"1","
"
"1","    No Information Rate :"
"1"," 0.84            "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 1.553e-08       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.553           "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 0.0001092       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.55144         "
"1","
"
"1","            Specificity :"
"1"," 0.95455         "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.69792         "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.91786         "
"1","
"
"1","             Prevalence :"
"1"," 0.15997         "
"1","
"
"1","         Detection Rate :"
"1"," 0.08822         "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.12640         "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.75299         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," yes             "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","confusionMatrix(stepBicPredsOut, validation$Closed_Account, positive = ""yes"")"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","   no"
"1","  yes"
"1","
       no "
"1"," 1220"
"1","  109"
"1","
       yes"
"1","   56"
"1","  134"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.8914          "
"1","
"
"1","                 95% CI :"
"1"," (0.8746, 0.9066)"
"1","
"
"1","    No Information Rate :"
"1"," 0.84            "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 6.333e-09       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.5567          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 5.161e-05       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.55144         "
"1","
"
"1","            Specificity :"
"1"," 0.95611         "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.70526         "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.91798         "
"1","
"
"1","             Prevalence :"
"1"," 0.15997         "
"1","
"
"1","         Detection Rate :"
"1"," 0.08822         "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.12508         "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.75378         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," yes             "
"1","
"
"1","                         "
"1","                 "
"1","
"
